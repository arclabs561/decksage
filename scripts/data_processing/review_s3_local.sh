#!/bin/bash # Review S3 and local data using s5cmd set -euo pipefail echo "======================================================================" echo "S3 vs LOCAL DATA REVIEW" echo "======================================================================" echo "" # Check s5cmd if ! command -v s5cmd &> /dev/null; then echo "Warning: s5cmd not found. Install: https://github.com/peak/s5cmd" echo " Falling back to aws cli (slower)..." USE_S5CMD=false else USE_S5CMD=true echo " Using s5cmd (fast S3 operations)" fi BUCKET="s3://games-collections" echo "" echo " S3 Games Data:" echo "----------------------------------------------------------------------" if [[ "$USE_S5CMD" == "true" ]]; then for game in magic pokemon yugioh digimon onepiece riftbound; do count=$(s5cmd ls "$BUCKET/games/${game}/" 2>&1 | wc -l | tr -d ' ') if [[ $count -gt 0 ]]; then size=$(s5cmd du "$BUCKET/games/${game}/" 2>&1 | tail -1 | awk '{print $1}' || echo "?") printf " %-20s %8s files %s\n" "$game" "$count" "$size" fi done else aws s3 ls "$BUCKET/games/" --recursive 2>&1 | head -20 fi echo "" echo " S3 Processed Data:" echo "----------------------------------------------------------------------" if [[ "$USE_S5CMD" == "true" ]]; then s5cmd ls "$BUCKET/processed/" 2>&1 | head -20 | awk '{print $NF}' | sed 's|s3://games-collections/processed/||' | while read f; do [[ -n "$f" ]] && echo " $f" done else aws s3 ls "$BUCKET/processed/" 2>&1 | head -20 fi echo "" echo "ðŸ“ Local Processed Data:" echo "----------------------------------------------------------------------" if [[ -d "data/processed" ]]; then for f in data/processed/*.csv data/processed/*.jsonl 2>/dev/null; do [[ -f "$f" ]] || continue size=$(du -h "$f" 2>/dev/null | cut -f1) lines=$(wc -l < "$f" 2>/dev/null | tr -d ' ' || echo "?") printf " %-50s %8s %10s lines\n" "$(basename "$f")" "$size" "$lines" done else echo " Warning: data/processed/ not found" fi echo "" echo " S3 Summary:" echo "----------------------------------------------------------------------" if [[ "$USE_S5CMD" == "true" ]]; then s5cmd du "$BUCKET/" 2>&1 | tail -3 else aws s3 ls "$BUCKET/" --recursive --human-readable --summarize 2>&1 | tail -5 fi echo "" echo "======================================================================"
