#!/bin/bash # Sync all important data to S3 for backup set -euo pipefail BUCKET="s3://games-collections" SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)" PROJECT_ROOT="$(cd "$SCRIPT_DIR/.." && pwd)" cd "$PROJECT_ROOT" echo " Syncing data to S3 for backup..." echo "" # Function to sync with progress sync_file() { local local_path="$1" local s3_path="$2" local description="$3" if [ ! -f "$local_path" ]; then echo "Warning: Skipping $description: $local_path not found" return fi echo "ðŸ“¤ Syncing $description..." echo " Local: $local_path" echo " S3: $s3_path" aws s3 cp "$local_path" "$s3_path" --no-progress 2>&1 | tail -1 echo " Done" echo "" } # Function to sync directory sync_dir() { local local_dir="$1" local s3_prefix="$2" local description="$3" if [ ! -d "$local_dir" ]; then echo "Warning: Skipping $description: $local_dir not found" return fi echo "ðŸ“¤ Syncing $description..." echo " Local: $local_dir" echo " S3: $s3_prefix" aws s3 sync "$local_dir" "$s3_prefix" --no-progress --exclude "*.pyc" --exclude "__pycache__/*" 2>&1 | tail -3 echo " Done" echo "" } # 1. Processed data files echo "=== Processed Data ===" sync_file "data/processed/pairs_multi_game.csv" "$BUCKET/processed/pairs_multi_game.csv" "Multi-game pairs" sync_file "data/processed/pairs_large.csv" "$BUCKET/processed/pairs_large.csv" "Large pairs" 2>/dev/null || echo "Warning: pairs_large.csv not found locally (may be S3-only)" sync_file "data/processed/card_attributes_enriched.csv" "$BUCKET/processed/card_attributes_enriched.csv" "Card attributes (enriched)" sync_file "data/processed/card_attributes_minimal.csv" "$BUCKET/processed/card_attributes_minimal.csv" "Card attributes (minimal)" sync_file "data/processed/decks_all_final.jsonl" "$BUCKET/processed/decks_all_final.jsonl" "All decks (enhanced, final)" 2>/dev/null || echo "Warning: decks_all_final.jsonl not found" sync_file "data/processed/decks_pokemon.jsonl" "$BUCKET/processed/decks_pokemon.jsonl" "Pokemon decks" 2>/dev/null || echo "Warning: decks_pokemon.jsonl not found" # 2. Graph data echo "=== Graph Data ===" sync_dir "data/graphs" "$BUCKET/graphs/" "Graph files" # 3. Embeddings echo "=== Embeddings ===" sync_dir "data/embeddings" "$BUCKET/embeddings/" "Embedding files" # 4. Experiments echo "=== Experiments ===" sync_dir "experiments" "$BUCKET/experiments/" "Experiment results and test sets" # 5. Annotations if [ -d "annotations" ]; then echo "=== Annotations ===" sync_dir "annotations" "$BUCKET/annotations/" "Annotation files" fi echo " Sync complete!" echo "" echo " Summary:" echo " Check: aws s3 ls $BUCKET/ --recursive | wc -l" echo " Size: aws s3 ls $BUCKET/ --recursive --summarize | tail -1"