#!/usr/bin/env python3 """ Bulk remove emojis from Python and shell scripts. Replaces emojis with plain text equivalents. """ import re from pathlib import Path import sys # Emoji replacements REPLACEMENTS = { "Warning:": "Warning:", "": "", # Remove success emojis "Error:": "Error:", "": "", # Remove chart emojis "": "", # Remove refresh emojis "": "", # Remove broom emojis "": "", # Remove download emojis "": "", # Remove lightbulb emojis "": "", # Remove fire emojis "": "", # Remove target emojis "": "", # Remove sleep emojis "": "", # Remove rocket emojis "": "", # Remove star emojis } def remove_emojis_from_file(filepath: Path, dry_run: bool = False) -> int: """Remove emojis from a file. Returns number of replacements.""" try: content = filepath.read_text(encoding='utf-8') original = content replacements = 0 for emoji, replacement in REPLACEMENTS.items(): if emoji in content: if replacement: # Replace with text, handling spacing content = content.replace(emoji, replacement) # Clean up double spaces content = re.sub(r' +', ' ', content) # Clean up "Warning: " or "Error: " followed by space content = re.sub(r'(Warning|Error):\s+', r'\1: ', content) else: # Remove emoji and clean up spacing content = content.replace(emoji, '') # Remove leading/trailing spaces around removed emojis content = re.sub(r'\s+', ' ', content) content = re.sub(r'^\s+|\s+$', '', content, flags=re.MULTILINE) count = original.count(emoji) replacements += count if replacements > 0 and not dry_run: filepath.write_text(content, encoding='utf-8') print(f" {filepath}: {replacements} replacements") return replacements except Exception as e: print(f" Error processing {filepath}: {e}", file=sys.stderr) return 0 def main(): import argparse parser = argparse.ArgumentParser(description="Remove emojis from code files") parser.add_argument("--dry-run", action="store_true", help="Show what would be changed") parser.add_argument("--extensions", nargs="+", default=["py", "sh"], help="File extensions to process") args = parser.parse_args() project_root = Path(__file__).parent.parent.parent total_replacements = 0 files_processed = 0 for ext in args.extensions: pattern = f"**/*.{ext}" for filepath in project_root.rglob(pattern): # Skip certain directories if any(skip in str(filepath) for skip in [".venv", "node_modules", ".git", "archive", "__pycache__", ".cache"]): continue # Skip if already in archive if "archive" in str(filepath): continue replacements = remove_emojis_from_file(filepath, dry_run=args.dry_run) if replacements > 0: files_processed += 1 total_replacements += replacements print(f"\n{'Would process' if args.dry_run else 'Processed'} {files_processed} files, {total_replacements} total replacements") return 0 if __name__ == "__main__": sys.exit(main())