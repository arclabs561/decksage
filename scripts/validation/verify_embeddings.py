#!/usr/bin/env python3 """Verify the newly trained embeddings load correctly.""" import sys from pathlib import Path # Add src to path sys.path.insert(0, str(Path(__file__).parent / "src")) try: from gensim.models import KeyedVectors emb_path = Path("data/embeddings/magic_128d_test_pecanpy.wv") if not emb_path.exists(): print(f"Error: Embeddings file not found: {emb_path}") sys.exit(1) print(f"ğŸ“š Loading embeddings from {emb_path}...") wv = KeyedVectors.load(str(emb_path)) print(f" Embeddings loaded successfully!") print(f" - Vectors: {len(wv):,}") print(f" - Dimensions: {wv.vector_size}") print(f" - File size: {emb_path.stat().st_size / 1024 / 1024:.2f} MB") # Test similarity if len(wv) > 0: sample_keys = list(wv.key_to_index.keys())[:5] print(f"\nğŸ“ Sample card names: {sample_keys[:3]}") test_card = sample_keys[0] similar = wv.most_similar(test_card, topn=3) print(f"\nğŸ” Test similarity for '{test_card}':") for card, score in similar: print(f" - {card}: {score:.4f}") print("\n Embeddings are valid and ready to use!") sys.exit(0) except ImportError as e: print(f"Error: Import error: {e}") print(" Install gensim: pip install gensim") sys.exit(1) except Exception as e: print(f"Error: Error loading embeddings: {e}") import traceback traceback.print_exc() sys.exit(1)