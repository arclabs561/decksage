#!/bin/bash # Live monitoring of EC2 training INSTANCE_ID="i-045dc67caaaacbc38" OUTPUT_NAME="magic_128d_test_pecanpy.wv" echo "==========================================" echo "EC2 Training Live Monitor" echo "==========================================" echo "" # Instance status echo " Instance:" aws ec2 describe-instances --instance-ids $INSTANCE_ID \ --query 'Reservations[0].Instances[0].{ID:InstanceId,Type:InstanceType,State:State.Name,Spot:SpotInstanceRequestId}' \ --output table echo "" echo "ðŸ“¡ SSM Status:" aws ssm describe-instance-information \ --filters "Key=InstanceIds,Values=$INSTANCE_ID" \ --query 'InstanceInformationList[0].{Status:PingStatus,LastPing:LastPingDateTime}' \ --output table echo "" echo "ðŸ”§ Training Commands:" aws ssm list-commands --instance-id $INSTANCE_ID --max-items 3 \ --query 'Commands[*].{ID:CommandId,Status:Status,Time:RequestedDateTime}' \ --output table # Get latest command details LATEST_CMD=$(aws ssm list-commands --instance-id $INSTANCE_ID --max-items 1 --query 'Commands[0].CommandId' --output text 2>/dev/null) if [ -n "$LATEST_CMD" ] && [ "$LATEST_CMD" != "None" ]; then echo "" echo "ðŸ“ Latest Command Status:" aws ssm get-command-invocation --command-id $LATEST_CMD --instance-id $INSTANCE_ID \ --query '{Status:Status,Output:StandardOutputContent,Error:StandardErrorContent}' \ --output json 2>&1 | jq -r '.Status, .StandardOutputContent, .StandardErrorContent' 2>/dev/null || \ aws ssm get-command-invocation --command-id $LATEST_CMD --instance-id $INSTANCE_ID \ --query '{Status:Status}' --output table fi echo "" echo "ðŸ“¦ S3 Output:" aws s3 ls s3://games-collections/embeddings/$OUTPUT_NAME 2>&1 | head -1 || echo " Not uploaded yet" echo "" echo "=========================================="set -euo pipefail
