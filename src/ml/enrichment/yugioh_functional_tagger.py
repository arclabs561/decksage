#!/usr/bin/env python3 """ Yu-Gi-Oh! Functional Tagging System Assigns functional roles/tags to YGO cards based on their effects and card types. Functional roles: - Removal (monster, spell/trap, backrow) - Negation (effects, summons, activations) - Search/Tutors - Special summon support - Graveyard effects - Hand traps - Floodgates - Win conditions """ import json import re from dataclasses import dataclass, asdict from pathlib import Path from typing import Dict, List @dataclass class YugiohFunctionalTags: """Functional classification for a YGO card""" card_name: str card_type: str # Monster, Spell, Trap # Removal monster_removal: bool = False # Destroys/banishes monsters spell_trap_removal: bool = False # Destroys/banishes spells/traps backrow_removal: bool = False # Removes set cards banish: bool = False # Banishes cards non_destruction_removal: bool = False # Returns, tributes, etc. # Negation effect_negation: bool = False # Negates effects summon_negation: bool = False # Negates summons activation_negation: bool = False # Negates activations omni_negate: bool = False # Negates anything # Search/Tutors searcher: bool = False # Searches deck search_archetype: bool = False # Searches archetype cards search_monster: bool = False # Searches monsters search_spell: bool = False # Searches spells search_trap: bool = False # Searches traps # Special Summon special_summon: bool = False # Can special summon itself summon_from_deck: bool = False # Summons from deck summon_from_grave: bool = False # Summons from graveyard extra_deck_summon: bool = False # Fusion/Synchro/Xyz/Link support # Graveyard graveyard_effect: bool = False # Activates in graveyard graveyard_setup: bool = False # Sends cards to GY recursion: bool = False # Returns from GY # Hand Traps hand_trap: bool = False # Activates from hand on opponent's turn quick_effect: bool = False # Quick Effect # Board Control floodgate: bool = False # Prevents actions lock: bool = False # Locks opponent out of mechanics stun: bool = False # Disrupts opponent's plays # Win Conditions win_condition: bool = False # Alternative win condition otk_enabler: bool = False # Enables OTK # Monster Types (for monsters) tuner: bool = False gemini: bool = False spirit: bool = False union: bool = False # Spell/Trap Types continuous: bool = False # Continuous Spell/Trap counter_trap: bool = False # Counter Trap field_spell: bool = False # Field Spell equip_spell: bool = False # Equip Spell # Draw/Mill draw: bool = False # Draws cards mill: bool = False # Mills cards # Protection targeting_protection: bool = False destruction_protection: bool = False battle_protection: bool = False # Tokens/Counters generates_tokens: bool = False uses_counters: bool = False class YugiohFunctionalTagger: """Tags YGO cards with functional roles""" def tag_card(self, card_data: dict) -> YugiohFunctionalTags: """Tag a YGO card with functional roles""" name = card_data.get("name", "") card_type = card_data.get("type", "") desc = card_data.get("desc", "").lower() tags = YugiohFunctionalTags( card_name=name, card_type=self._get_primary_type(card_type) ) # Monster-specific tags if "Monster" in card_type: tags = self._tag_monster(tags, card_type, desc) # Spell-specific tags elif "Spell" in card_type: tags = self._tag_spell(tags, card_type, desc) # Trap-specific tags elif "Trap" in card_type: tags = self._tag_trap(tags, card_type, desc) # Common tags for all cards tags = self._tag_common(tags, desc) return tags def _get_primary_type(self, card_type: str) -> str: """Extract primary card type""" if "Monster" in card_type: return "Monster" elif "Spell" in card_type: return "Spell" elif "Trap" in card_type: return "Trap" return "Unknown" def _tag_monster(self, tags, card_type, desc): """Tag Monster cards""" # Monster subtypes if "Tuner" in card_type: tags.tuner = True if "Gemini" in card_type: tags.gemini = True if "Spirit" in card_type: tags.spirit = True if "Union" in card_type: tags.union = True # Special summon if "special summon" in desc: tags.special_summon = True # Quick effects if "quick effect" in desc or "(quick effect)" in desc: tags.quick_effect = True # Hand traps (effects from hand during opponent's turn) # Key indicators: discard from hand + (Quick Effect) or during opponent's turn is_quick_effect = tags.quick_effect discards_from_hand = "discard this card" in desc or "discard it" in desc affects_opponent = "opponent" in desc or "when" in desc if discards_from_hand and (is_quick_effect or affects_opponent): tags.hand_trap = True # Graveyard effects if "graveyard" in desc and ("this card" in desc or "from the gy" in desc): tags.graveyard_effect = True if "send" in desc and ("to the gy" in desc or "to the graveyard" in desc): tags.graveyard_setup = True return tags def _tag_spell(self, tags, card_type, desc): """Tag Spell cards""" if "Continuous" in card_type: tags.continuous = True if "Field" in card_type: tags.field_spell = True if "Equip" in card_type: tags.equip_spell = True # Quick-Play Spells can be activated during opponent's turn if "Quick-Play" in card_type: tags.quick_effect = True return tags def _tag_trap(self, tags, card_type, desc): """Tag Trap cards""" if "Continuous" in card_type: tags.continuous = True if "Counter" in card_type: tags.counter_trap = True tags.activation_negation = True # Counter traps negate return tags def _tag_common(self, tags, desc): """Tag common effects across all card types""" # Removal if "destroy" in desc: if "monster" in desc: tags.monster_removal = True if "spell" in desc or "trap" in desc or "card(s)" in desc: tags.spell_trap_removal = True if "face-down" in desc or "set" in desc: tags.backrow_removal = True if "banish" in desc or "remove from play" in desc: tags.banish = True if "return" in desc or "shuffle" in desc or "tribute" in desc: tags.non_destruction_removal = True # Negation if "negate" in desc: tags.effect_negation = True if "activation" in desc: tags.activation_negation = True if "summon" in desc: tags.summon_negation = True if "activate" in desc and ("spell" in desc or "trap" in desc or "monster effect" in desc): tags.omni_negate = True # Search if "add" in desc and ("from your deck" in desc or "from the deck" in desc): tags.searcher = True if "monster" in desc: tags.search_monster = True if "spell" in desc: tags.search_spell = True if "trap" in desc: tags.search_trap = True # Special Summon support if "special summon" in desc: if "from your deck" in desc or "from the deck" in desc: tags.summon_from_deck = True if "from your graveyard" in desc or "from the gy" in desc: tags.summon_from_grave = True if "fusion" in desc or "synchro" in desc or "xyz" in desc or "link" in desc: tags.extra_deck_summon = True # Graveyard if "from the gy" in desc or "from your graveyard" in desc: if "to your hand" in desc or "to the field" in desc: tags.recursion = True # Floodgates/Locks if ("cannot" in desc or "can't" in desc) and ("opponent" in desc or "other players" in desc): tags.floodgate = True if "special summon" in desc or "normal summon" in desc: tags.lock = True tags.stun = True # Win conditions if "win the duel" in desc or "wins the duel" in desc: tags.win_condition = True # OTK enablers (double attacks, direct attacks) if "attack directly" in desc or "twice" in desc or "additional attack" in desc: tags.otk_enabler = True # Draw/Mill if "draw" in desc and "card" in desc: tags.draw = True if "send" in desc and ("from your deck" in desc or "from the deck" in desc) and ("to the gy" in desc or "to the graveyard" in desc): tags.mill = True # Protection if "cannot be targeted" in desc or "can't be targeted" in desc: tags.targeting_protection = True if "cannot be destroyed" in desc or "can't be destroyed" in desc: tags.destruction_protection = True if "cannot be destroyed by battle" in desc: tags.battle_protection = True # Tokens/Counters if "token" in desc: tags.generates_tokens = True if "counter" in desc and "place" in desc: tags.uses_counters = True return tags def tag_deck_cards(self, deck_cards: List[dict]) -> Dict[str, YugiohFunctionalTags]: """Tag all cards in a deck""" result = {} for card_data in deck_cards: name = card_data.get("name", "") if name: result[name] = self.tag_card(card_data) return result def export_tags(self, cards_data: List[dict], output_path: Path): """Export all tags for YGO cards""" print(f"Tagging {len(cards_data)} YGO cards...") results = [] for card_data in cards_data: tags = self.tag_card(card_data) results.append(asdict(tags)) with open(output_path, "w") as f: json.dump(results, f, indent=2) print(f" Exported {len(results)} YGO card tags to {output_path}") if __name__ == "__main__": # Example usage tagger = YugiohFunctionalTagger() # Example card - Ash Blossom & Joyous Spring (famous hand trap) example_card = { "name": "Ash Blossom & Joyous Spring", "type": "Effect Monster", "desc": "When a card or effect is activated that includes any of these effects (Quick Effect): You can discard this card; negate that effect. ● Add a card from the Deck to the hand. ● Special Summon from the Deck. ● Send a card from the Deck to the GY." } tags = tagger.tag_card(example_card) print(f"\n{tags.card_name} tags:") print(f" Hand Trap: {tags.hand_trap}") print(f" Effect Negation: {tags.effect_negation}") print(f" Quick Effect: {tags.quick_effect}") # Example card - Pot of Greed (banned card draw) example_card2 = { "name": "Pot of Greed", "type": "Spell Card", "desc": "Draw 2 cards." } tags2 = tagger.tag_card(example_card2) print(f"\n{tags2.card_name} tags:") print(f" Draw: {tags2.draw}")